
 <!DOCTYPE html>
<html>
  <head>
    <title>Is It Sunny?</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
	<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
	<script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
	<script>
	  

	  function Places (name, latitude, longitude, array){
		this.name = name;
		this.latitude = latitude;
		this.longitude = longitude;
		this.spot = {};
		this.spot.lat = latitude;
		this.spot.lng = longitude;
		array.push(this);
	  }


	  function buttonMaker(place){
		var button = document.createElement('button');
		button.id = place.name;
		button.value = place.name;
		var buttonText = document.createTextNode(place.name);
		button.appendChild(buttonText);
		sidebar.appendChild(button);
	  }

	  function makeButtons(array){
		for(var i = 0; i < array.length; i++){
			buttonMaker(array[i]);
		}
	  }

	  var markers = [];

      var container = document.createElement('div');
	  container.id = 'container';
	  container.style.width = "100%";
	  container.style.height = "2000px";

	  var sidebar = document.createElement('div');
	  sidebar.id = 'sidebar';
	  sidebar.style.width = "75px";
	  sidebar.style.backgroundColor = "#00ff48";
	  sidebar.style.height = "100%";
	  sidebar.style.float = "left";
	  sidebar.style.margin = "0";
	  sidebar.style.padding = "0";
	  sidebar.style.float = "left";
	  container.appendChild(sidebar);

	  var resultsContainer = document.createElement("div");
	  resultsContainer.id = "resultsContainer";
	  resultsContainer.style.float = "left";

	  var futureResults = document.createElement("div");
	  futureResults.id = "futureResults";
	  futureResults.style.float = "left";
	  futureResults.style.marginLeft = "8px";

	  var places = [];
	  var urca = new Places('Urca', -22.955430, -43.164800, places);
	  var copa = new Places('Copa', -22.9689662, -43.1844084, places);
	  var ipanema = new Places('Ipanema', -22.986450, -43.205995, places);
	  var leblon = new Places('Leblon', -22.987649, -43.221640, places);
	  var sanca = new Places('Sanca', -22.999373, -43.264027, places);
	  var joatinga = new Places('Joatinga', -23.014354, -43.290364, places);
	  var barra = new Places('Barra', -23.012240, -43.323770, places);
	  var reserva = new Places('Reserva', -23.012849, -43.388988, places);
	  var macumba = new Places('Macumba', -23.033037, -43.4862847, places);  
	  var recreio = new Places('Recreio', -23.028383, -43.464918, places);
	  var prainha = new Places('Prainha', -23.040962, -43.505379, places);
	  var grumari = new Places('Grumari', -23.048466, -43.524417, places);
	  var guaratiba = new Places('Guaratiba', -23.067656, -43.567932, places);

	  $(document).ready(function(){
			
		makeButtons(places);

		$("body").on('click', 'button', function(){
			resultsContainer.innerHTML = " ";
			var APIKEY = "e964d33cde30c141523b46f7f27e0007";
			var LATITUDE;
			var LONGITUDE;
			var btnValue = $(this).text();
			for(var i = 0; i < places.length; i++){
				if(btnValue == places[i]["name"]){
					LATITUDE = places[i]["latitude"];
					LONGITUDE = places[i]["longitude"];
					resultsContainer.innerHTML += "<h5>" + places[i]["name"] + "</h5>";
				}	
				
			}
			
			var weatherAPI = "https://api.forecast.io/forecast/" + APIKEY + "/" + LATITUDE + "," + LONGITUDE + "?callback=?";
			function displayWeather(data){
				resultsContainer.innerHTML += "<ul>";
				resultsContainer.innerHTML += "<li>" + data.currently.icon + "</l1>";		
				resultsContainer.innerHTML += "<li>" + data.currently.summary + "</l1>";
				resultsContainer.innerHTML += "<li>" + data.currently.temperature + "</l1>";
				resultsContainer.innerHTML += "<li>" + data.currently.windSpeed + "</l1>";
				resultsContainer.innerHTML += "<li>" + data.currently.precipProbability + "</l1>";
				resultsContainer.innerHTML += "<li>" + data.currently.humidity + "</l1>";
				resultsContainer.innerHTML += "<li>" + data.currently.pressure + "</l1>";
				resultsContainer.innerHTML += "</ul>";
			}	

			$.getJSON(weatherAPI, displayWeather);	
				
			container.appendChild(resultsContainer);


			});

		function loopFutureResults(APIKEY, LATITUDE, LONGITUDE, TIME){
			var weatherAPI = "https://api.forecast.io/forecast/" + APIKEY + "/" + LATITUDE + "," + LONGITUDE + "," + TIME + "?callback=?";
		
			function displayWeather(data){
					futureResults += "<ul>";
					futureResults += "<li>" + data.currently.icon + "</l1>";		
					futureResults += "<li>" + data.currently.summary + "</l1>";
					futureResults += "<li>" + data.currently.temperature + "</l1>";
					futureResults += "<li>" + data.currently.windSpeed + "</l1>";
					futureResults += "<li>" + data.currently.precipProbability + "</l1>";
					futureResults += "<li>" + data.currently.humidity + "</l1>";
					futureResults += "<li>" + data.currently.pressure + "</l1>";
					futureResults += "</ul>";
					}
			$.getJSON(weatherAPI, displayWeather);	

			container.appendChild(futureResults);
			}
		// WHEN A BUTTON IS CLICKED THE FOLLOWING FUNCTION ALSO HAPPENS
		$("body").on('click', 'button', function(){
			futureResults.innerHTML = " ";
				var APIKEY = "e964d33cde30c141523b46f7f27e0007";
				var LATITUDE;
				var LONGITUDE;
				var btnValue = $(this).text();
				for(var i = 0; i < places.length; i++){
					if(btnValue == places[i]["name"]){
						LATITUDE = places[i]["latitude"];
						LONGITUDE = places[i]["longitude"];
						futureResults.innerHTML += "<h5>" + places[i]["name"]+ " in " + 12 * (i+1) + " hours" + "</h5>";
					}	
				}
				var timeNow = Date.now();
				timeNow /= 1000;
				timeNow -= (86400 / 24) * 3;
				var timeTomorrow = timeNow + 86400;
				var TIME = Math.round(timeTomorrow);
			
				for (var i = 1; i <= 10; i++){
					var placesFutureResults = loopFutureResults(APIKEY, LATITUDE, LONGITUDE, TIME);
					$("#places"+i).html(placesFutureResults);
					TIME = TIME + 43200;	
				}
						
				container.appendChild(futureResults);
			});

			document.body.appendChild(container);
		  });
		
	</script>
	<style>
	 	//STYLES PROVIDED BY GOOGLE MAPS API
	      html, body {
	        height: 100%;
	        margin: 0;
	        padding: 0;
	      }
	      button {
	      	margin: 3px 3px 3px 3px;
	      }
	      #map {
	        height: 250px;
	       	margin: 5px;
	        width: 60%;
	        float: left;
	      }
	</style>
	  </head>
	  	<body>
		    <div id="map"></div>
		    <script>
		      var map;
		      function initMap() {
		        map = new google.maps.Map(document.getElementById('map'), {
		          center: {lat:-22.98, lng: -43.26},
		          zoom: 12
		        }); 
		      
		    
		    for(var i = 0; i < places.length; i++){
		        	var name = places[i]["name"];
		        	var label = name.charAt(0);
		        	 var marker = new google.maps.Marker({
					    position: places[i]["spot"],
					    map: map,
					    title: name,
					    id : label,
					    label: label,
					    animation: google.maps.Animation.DROP
			  		});
			  		marker.addListener('click', function() {
   					map = marker.getMap();
   					map.setZoom(16);
    				map.setCenter(this.getPosition());
  					});
  					marker.addListener('dblclick', function() {
   					map = marker.getMap();
   					map.setZoom(12);
    				map.setCenter({lat:-22.98, lng: -43.26});
  					});
  					markers.push([marker, places[i]["name"]]);
		        }
		    }


		        container.appendChild(document.getElementById('map'));
		      
		    </script>
		    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCz3T2t3rfTwN_esxfWWqWQK9DNBOIU7oQ&callback=initMap"
		    async defer></script>
		</body>
<html>